{% extends "student/student_base.html" %}
{% block title %}Account Settings - KapiyuGuide{% endblock %}

{% block extra_head %}
<style>
  .settings-card {
    background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
    border: 1px solid #e2e8f0;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
    transition: all 0.3s ease;
  }

  .settings-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
  }

  .setting-item {
    background: linear-gradient(135deg, #f9fafb 0%, #ffffff 100%);
    border: 1px solid #e5e7eb;
    transition: all 0.2s ease;
  }

  .setting-item:hover {
    border-color: #3b82f6;
    transform: translateY(-1px);
  }

  .toggle-switch {
    position: relative;
    display: inline-block;
    width: 60px;
    height: 34px;
  }

  .toggle-switch input {
    opacity: 0;
    width: 0;
    height: 0;
  }

  .slider {
    position: absolute;
    cursor: pointer;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: #ccc;
    transition: .4s;
    border-radius: 34px;
  }

  .slider:before {
    position: absolute;
    content: "";
    height: 26px;
    width: 26px;
    left: 4px;
    bottom: 4px;
    background-color: white;
    transition: .4s;
    border-radius: 50%;
  }

  input:checked + .slider {
    background-color: #3b82f6;
  }

  input:checked + .slider:before {
    transform: translateX(26px);
  }

  .input-field {
    border: 2px solid #e5e7eb;
    transition: all 0.2s ease;
  }

  .input-field:focus {
    border-color: #3b82f6;
    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
  }

  .section-header {
    border-left: 4px solid #3b82f6;
    background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%);
  }

  .btn-primary {
    background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
    box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
    transition: all 0.2s ease;
  }

  .btn-primary:hover {
    transform: translateY(-1px);
    box-shadow: 0 6px 16px rgba(59, 130, 246, 0.4);
  }

  .btn-secondary {
    background: linear-gradient(135deg, #6b7280 0%, #4b5563 100%);
    transition: all 0.2s ease;
  }

  .btn-secondary:hover {
    transform: translateY(-1px);
    background: linear-gradient(135deg, #4b5563 0%, #374151 100%);
  }
</style>
{% endblock %}

{% block content %}
<div class="container mx-auto px-4 py-6">
  <!-- Page Header -->
  <div class="flex flex-col md:flex-row md:items-center md:justify-between mb-8">
    <div>
      <h1 class="text-3xl font-bold text-gray-900 mb-2">Account Settings</h1>
      <p class="text-gray-600">Manage your account preferences and privacy settings</p>
    </div>
    <div class="mt-4 md:mt-0">
      <a
        href="{{ url_for('student.profile') }}"
        class="inline-flex items-center px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors duration-200"
      >
        <i class="fas fa-arrow-left mr-2"></i>
        Back to Profile
      </a>
    </div>
  </div>

  <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
    <!-- Settings Navigation -->
    <div class="lg:col-span-1">
      <div class="settings-card rounded-xl p-6">
        <h3 class="text-lg font-semibold text-gray-900 mb-4">Settings Menu</h3>
        <nav class="space-y-2">
          <a href="#personal" class="flex items-center px-3 py-2 text-sm font-medium text-blue-600 bg-blue-50 rounded-lg">
            <i class="fas fa-user mr-3"></i>
            Personal Information
          </a>
          <a href="#video" class="flex items-center px-3 py-2 text-sm font-medium text-gray-700 hover:text-blue-600 hover:bg-gray-50 rounded-lg transition-colors">
            <i class="fas fa-video mr-3"></i>
            Video Settings
          </a>
          <a href="#notifications" class="flex items-center px-3 py-2 text-sm font-medium text-gray-700 hover:text-blue-600 hover:bg-gray-50 rounded-lg transition-colors">
            <i class="fas fa-bell mr-3"></i>
            Notifications
          </a>
          <a href="#privacy" class="flex items-center px-3 py-2 text-sm font-medium text-gray-700 hover:text-blue-600 hover:bg-gray-50 rounded-lg transition-colors">
            <i class="fas fa-shield-alt mr-3"></i>
            Privacy & Security
          </a>
        </nav>
      </div>
    </div>

    <!-- Settings Content -->
    <div class="lg:col-span-2 space-y-8">
      <!-- Personal Information Section -->
      <div id="personal" class="settings-card rounded-xl p-6">
        <div class="section-header p-4 rounded-lg mb-6">
          <h3 class="text-lg font-semibold text-gray-900 flex items-center">
            <i class="fas fa-user mr-2 text-blue-600"></i>
            Personal Information
          </h3>
          <p class="text-sm text-gray-600 mt-1">Update your personal details and contact information</p>
        </div>

        <form class="space-y-6">
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">First Name</label>
              <input
                type="text"
                value="{{ current_user.first_name }}"
                class="input-field w-full px-3 py-2 rounded-lg focus:outline-none"
                readonly
              />
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">Last Name</label>
              <input
                type="text"
                value="{{ current_user.last_name }}"
                class="input-field w-full px-3 py-2 rounded-lg focus:outline-none"
                readonly
              />
            </div>
          </div>

          {% if current_user.middle_name %}
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Middle Name</label>
            <input
              type="text"
              value="{{ current_user.middle_name }}"
              class="input-field w-full px-3 py-2 rounded-lg focus:outline-none"
              readonly
            />
          </div>
          {% endif %}

          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Email Address</label>
            <input
              type="email"
              value="{{ current_user.email }}"
              class="input-field w-full px-3 py-2 rounded-lg focus:outline-none"
              readonly
            />
          </div>

          {% if student.student_number %}
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Student Number</label>
            <input
              type="text"
              value="{{ student.student_number }}"
              class="input-field w-full px-3 py-2 rounded-lg focus:outline-none"
              readonly
            />
          </div>
          {% endif %}

          <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
            <div class="flex">
              <i class="fas fa-info-circle text-yellow-600 mt-1 mr-3"></i>
              <div>
                <h4 class="text-sm font-medium text-yellow-800">Information Notice</h4>
                <p class="text-sm text-yellow-700 mt-1">
                  Personal information changes require admin approval. Please contact your system administrator to update these details.
                </p>
              </div>
            </div>
          </div>
        </form>
      </div>

      <!-- Video Settings Section -->
      <div id="video" class="settings-card rounded-xl p-6">
        <div class="section-header p-4 rounded-lg mb-6">
          <h3 class="text-lg font-semibold text-gray-900 flex items-center">
            <i class="fas fa-video mr-2 text-blue-600"></i>
            Video Call Settings
          </h3>
          <p class="text-sm text-gray-600 mt-1">Configure your video counseling preferences</p>
        </div>

        <form class="space-y-6">
          <div class="setting-item p-4 rounded-lg">
            <div class="flex items-center justify-between">
              <div>
                <h4 class="text-sm font-medium text-gray-900">Video Call Notifications</h4>
                <p class="text-sm text-gray-600">Receive real-time notifications for video calls</p>
              </div>
              <label class="toggle-switch">
                <input type="checkbox" {% if current_user.video_call_notifications %}checked{% endif %} disabled>
                <span class="slider"></span>
              </label>
            </div>
          </div>

          <div class="setting-item p-4 rounded-lg">
            <div class="flex items-center justify-between">
              <div>
                <h4 class="text-sm font-medium text-gray-900">Email Reminders</h4>
                <p class="text-sm text-gray-600">Get email reminders for upcoming sessions</p>
              </div>
              <label class="toggle-switch">
                <input type="checkbox" {% if current_user.video_call_email_reminders %}checked{% endif %} disabled>
                <span class="slider"></span>
              </label>
            </div>
          </div>

          <div class="setting-item p-4 rounded-lg">
            <div>
              <h4 class="text-sm font-medium text-gray-900 mb-2">Preferred Video Quality</h4>
              <select class="input-field w-full px-3 py-2 rounded-lg focus:outline-none" disabled>
                <option value="auto" {% if current_user.preferred_video_quality == 'auto' %}selected{% endif %}>Auto</option>
                <option value="low" {% if current_user.preferred_video_quality == 'low' %}selected{% endif %}>Low</option>
                <option value="medium" {% if current_user.preferred_video_quality == 'medium' %}selected{% endif %}>Medium</option>
                <option value="high" {% if current_user.preferred_video_quality == 'high' %}selected{% endif %}>High</option>
              </select>
            </div>
          </div>

          <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
            <div class="flex">
              <i class="fas fa-info-circle text-blue-600 mt-1 mr-3"></i>
              <div>
                <h4 class="text-sm font-medium text-blue-800">Settings Notice</h4>
                <p class="text-sm text-blue-700 mt-1">
                  Video settings are currently view-only. Contact your counselor if you need to modify these preferences.
                </p>
              </div>
            </div>
          </div>
        </form>
      </div>

      <!-- Coming Soon Sections -->
      <div class="settings-card rounded-xl p-6">
        <div class="text-center py-8">
          <div class="w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4">
            <i class="fas fa-tools text-gray-400 text-xl"></i>
          </div>
          <h3 class="text-lg font-semibold text-gray-900 mb-2">More Settings Coming Soon</h3>
          <p class="text-gray-600 mb-4">We're working on additional customization options for your account.</p>
          <div class="flex flex-wrap justify-center gap-2">
            <span class="px-3 py-1 bg-gray-100 text-gray-700 rounded-full text-sm">Notification Preferences</span>
            <span class="px-3 py-1 bg-gray-100 text-gray-700 rounded-full text-sm">Privacy Controls</span>
            <span class="px-3 py-1 bg-gray-100 text-gray-700 rounded-full text-sm">Security Settings</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block scripts %}
<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Smooth scrolling for navigation links
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
      anchor.addEventListener('click', function (e) {
        e.preventDefault();
        const target = document.querySelector(this.getAttribute('href'));
        if (target) {
          target.scrollIntoView({
            behavior: 'smooth',
            block: 'start'
          });
        }
      });
    });

    // Update active navigation item on scroll
    const sections = document.querySelectorAll('[id]');
    const navLinks = document.querySelectorAll('nav a[href^="#"]');

    function updateActiveNav() {
      let current = '';
      sections.forEach(section => {
        const sectionTop = section.offsetTop - 100;
        if (window.scrollY >= sectionTop) {
          current = section.getAttribute('id');
        }
      });

      navLinks.forEach(link => {
        link.classList.remove('text-blue-600', 'bg-blue-50');
        link.classList.add('text-gray-700');
        if (link.getAttribute('href') === `#${current}`) {
          link.classList.remove('text-gray-700');
          link.classList.add('text-blue-600', 'bg-blue-50');
        }
      });
    }

    window.addEventListener('scroll', updateActiveNav);
  });
</script>
{% endblock %}
