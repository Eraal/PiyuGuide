{% extends 'headerbase.html' %}

{% block title %}{{ office.name }} - {{ current_campus_name }}{% endblock %}

{% block content %}
<div class="min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50">
  <!-- Enhanced Breadcrumb with backdrop blur -->
  <div class="sticky top-0 z-10 backdrop-blur-md bg-white/80 border-b border-white/20 shadow-sm">
    <div class="container mx-auto px-4 py-3">
      <nav aria-label="Breadcrumb">
        <ol class="flex items-center space-x-2 text-sm">
          <li>
            <a href="{{ url_for('main.campus_selection') }}" 
               class="flex items-center text-slate-600 hover:text-blue-600 transition-colors duration-200">
              <i class="fas fa-home mr-1"></i>
              Home
            </a>
          </li>
          <li class="text-slate-400">
            <i class="fas fa-chevron-right text-xs"></i>
          </li>
          <li>
            <a href="{{ url_for('main.offices') }}" 
               class="text-slate-600 hover:text-blue-600 transition-colors duration-200">
              Offices
            </a>
          </li>
          <li class="text-slate-400">
            <i class="fas fa-chevron-right text-xs"></i>
          </li>
          <li class="text-slate-800 font-medium">{{ office.name }}</li>
        </ol>
      </nav>
    </div>
  </div>

  <!-- Hero Section -->
  <div class="relative overflow-hidden bg-gradient-to-r from-blue-900 via-blue-800 to-indigo-900">
    <!-- Animated background elements -->
    <div class="absolute inset-0">
      <div class="absolute top-1/4 left-1/4 w-64 h-64 bg-blue-400/10 rounded-full blur-3xl animate-pulse"></div>
      <div class="absolute bottom-1/4 right-1/4 w-80 h-80 bg-indigo-400/10 rounded-full blur-3xl animate-pulse delay-1000"></div>
    </div>
    
    <div class="relative container mx-auto px-4 py-16 text-center">
      <div class="max-w-4xl mx-auto">
        <!-- Office Icon/Logo -->
        <div class="inline-flex items-center justify-center w-20 h-20 bg-white/20 rounded-2xl mb-6 backdrop-blur-sm border border-white/30">
          <i class="fas fa-building text-3xl text-white"></i>
        </div>
        
        <h1 class="text-4xl md:text-6xl font-bold text-white mb-4 drop-shadow-lg">
          {{ office.name }}
        </h1>
        
        {% if office.description %}
        <p class="text-xl md:text-2xl text-blue-100 leading-relaxed max-w-3xl mx-auto mb-8">
          {{ office.description }}
        </p>
        {% endif %}

        <!-- Office Status and Quick Stats -->
        <div class="flex flex-wrap justify-center gap-6 mb-8">
          <!-- Availability Status -->
          <div class="bg-white/10 backdrop-blur-sm rounded-xl px-6 py-3 border border-white/20">
            {% if is_available %}
            <div class="flex items-center text-green-300">
              <div class="w-3 h-3 bg-green-400 rounded-full mr-2 animate-pulse"></div>
              <span class="font-semibold">Available Now</span>
            </div>
            {% else %}
            <div class="flex items-center text-red-300">
              <div class="w-3 h-3 bg-red-400 rounded-full mr-2"></div>
              <span class="font-semibold">Currently Unavailable</span>
            </div>
            {% endif %}
          </div>

          <!-- Quick Stats -->
          <div class="bg-white/10 backdrop-blur-sm rounded-xl px-6 py-3 border border-white/20">
            <div class="flex items-center text-white">
              <i class="fas fa-chart-line mr-2 text-blue-300"></i>
              <span class="font-semibold">{{ total_inquiries }} Total Inquiries</span>
            </div>
          </div>

          <div class="bg-white/10 backdrop-blur-sm rounded-xl px-6 py-3 border border-white/20">
            <div class="flex items-center text-white">
              <i class="fas fa-clock mr-2 text-orange-300"></i>
              <span class="font-semibold">{{ pending_inquiries }} Pending</span>
            </div>
          </div>
        </div>

        <!-- Action Buttons -->
        <div class="flex flex-col sm:flex-row justify-center gap-4">
          {% if is_available %}
          <a href="{{ url_for('student.create_inquiry', office_id=office.id) if current_user.is_authenticated and current_user.role == 'student' else url_for('auth.login') }}"
             class="inline-flex items-center px-8 py-4 bg-gradient-to-r from-emerald-500 to-emerald-600 text-white font-bold rounded-xl hover:from-emerald-600 hover:to-emerald-700 transition-all duration-300 shadow-xl hover:shadow-2xl transform hover:-translate-y-1">
            <i class="fas fa-plus mr-2"></i>
            Submit New Inquiry
          </a>
          {% endif %}
          
          <a href="{{ url_for('main.offices') }}"
             class="inline-flex items-center px-8 py-4 bg-white/20 text-white font-bold rounded-xl hover:bg-white/30 transition-all duration-300 backdrop-blur-sm border border-white/30">
            <i class="fas fa-arrow-left mr-2"></i>
            Back to All Offices
          </a>
        </div>
      </div>
    </div>
  </div>

  <!-- Main Content -->
  <div class="container mx-auto px-4 py-16">
    <div class="max-w-6xl mx-auto">
      <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
        
        <!-- Main Content Column -->
        <div class="lg:col-span-2 space-y-8">
          
          <!-- Services Section -->
          {% if concern_types %}
          <div class="bg-white rounded-2xl shadow-xl border border-slate-200 overflow-hidden">
            <div class="bg-gradient-to-r from-blue-600 to-blue-700 px-6 py-4">
              <h2 class="text-2xl font-bold text-white flex items-center">
                <i class="fas fa-concierge-bell mr-3"></i>
                Services Available
              </h2>
            </div>
            <div class="p-6">
              <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                {% for concern_type in concern_types %}
                <div class="group bg-gradient-to-br from-slate-50 to-blue-50 p-4 rounded-xl border border-slate-200 hover:border-blue-300 transition-all duration-300 hover:shadow-lg">
                  <div class="flex items-start space-x-3">
                    <div class="flex-shrink-0 w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center group-hover:bg-blue-200 transition-colors">
                      <i class="fas fa-tag text-blue-600"></i>
                    </div>
                    <div class="flex-1 min-w-0">
                      <h3 class="font-semibold text-slate-800 group-hover:text-blue-800 transition-colors">
                        {{ concern_type.name }}
                      </h3>
                      {% if concern_type.description %}
                      <p class="text-sm text-slate-600 mt-1 leading-relaxed">
                        {{ concern_type.description }}
                      </p>
                      {% endif %}
                    </div>
                  </div>
                </div>
                {% endfor %}
              </div>
            </div>
          </div>
          {% endif %}

          <!-- Recent Activity Section -->
          {% if recent_inquiries %}
          <div class="bg-white rounded-2xl shadow-xl border border-slate-200 overflow-hidden">
            <div class="bg-gradient-to-r from-indigo-600 to-indigo-700 px-6 py-4">
              <h2 class="text-2xl font-bold text-white flex items-center">
                <i class="fas fa-clock mr-3"></i>
                Recent Activity
              </h2>
            </div>
            <div class="p-6">
              <div class="space-y-4">
                {% for inquiry in recent_inquiries[:5] %}
                <div class="flex items-center space-x-4 p-4 bg-slate-50 rounded-xl border border-slate-200">
                  <div class="flex-shrink-0">
                    <div class="w-10 h-10 rounded-full flex items-center justify-center
                                {% if inquiry.status == 'resolved' %}bg-green-100 text-green-600
                                {% elif inquiry.status == 'pending' %}bg-orange-100 text-orange-600
                                {% elif inquiry.status == 'in_progress' %}bg-blue-100 text-blue-600
                                {% else %}bg-gray-100 text-gray-600{% endif %}">
                      <i class="fas fa-{% if inquiry.status == 'resolved' %}check{% elif inquiry.status == 'pending' %}clock{% elif inquiry.status == 'in_progress' %}spinner{% else %}question{% endif %}"></i>
                    </div>
                  </div>
                  <div class="flex-1 min-w-0">
                    <p class="text-sm font-medium text-slate-800 truncate">
                      {{ inquiry.concern_type.name if inquiry.concern_type else 'General Inquiry' }}
                    </p>
                    <p class="text-xs text-slate-600">
                      {{ inquiry.created_at.strftime('%B %d, %Y at %I:%M %p') }}
                    </p>
                  </div>
                  <div class="flex-shrink-0">
                    <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium
                                 {% if inquiry.status == 'resolved' %}bg-green-100 text-green-800
                                 {% elif inquiry.status == 'pending' %}bg-orange-100 text-orange-800
                                 {% elif inquiry.status == 'in_progress' %}bg-blue-100 text-blue-800
                                 {% else %}bg-gray-100 text-gray-800{% endif %}">
                      {{ inquiry.status|replace('_', ' ')|title }}
                    </span>
                  </div>
                </div>
                {% endfor %}
              </div>
            </div>
          </div>
          {% endif %}

        </div>

        <!-- Sidebar -->
        <div class="space-y-6">
          
          <!-- Office Statistics -->
          <div class="bg-white rounded-2xl shadow-xl border border-slate-200 overflow-hidden">
            <div class="bg-gradient-to-r from-slate-700 to-slate-800 px-6 py-4">
              <h3 class="text-xl font-bold text-white flex items-center">
                <i class="fas fa-chart-bar mr-2"></i>
                Statistics
              </h3>
            </div>
            <div class="p-6 space-y-4">
              
              <div class="flex items-center justify-between p-4 bg-blue-50 rounded-xl border border-blue-200">
                <div class="flex items-center space-x-3">
                  <div class="w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center">
                    <i class="fas fa-inbox text-blue-600"></i>
                  </div>
                  <div>
                    <p class="text-sm font-medium text-slate-700">Total Inquiries</p>
                    <p class="text-xs text-slate-500">All time</p>
                  </div>
                </div>
                <div class="text-2xl font-bold text-blue-600">{{ total_inquiries }}</div>
              </div>

              <div class="flex items-center justify-between p-4 bg-orange-50 rounded-xl border border-orange-200">
                <div class="flex items-center space-x-3">
                  <div class="w-10 h-10 bg-orange-100 rounded-lg flex items-center justify-center">
                    <i class="fas fa-clock text-orange-600"></i>
                  </div>
                  <div>
                    <p class="text-sm font-medium text-slate-700">Pending</p>
                    <p class="text-xs text-slate-500">Awaiting response</p>
                  </div>
                </div>
                <div class="text-2xl font-bold text-orange-600">{{ pending_inquiries }}</div>
              </div>

              <div class="flex items-center justify-between p-4 bg-green-50 rounded-xl border border-green-200">
                <div class="flex items-center space-x-3">
                  <div class="w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center">
                    <i class="fas fa-check-circle text-green-600"></i>
                  </div>
                  <div>
                    <p class="text-sm font-medium text-slate-700">Resolved</p>
                    <p class="text-xs text-slate-500">Successfully handled</p>
                  </div>
                </div>
                <div class="text-2xl font-bold text-green-600">{{ resolved_inquiries }}</div>
              </div>

            </div>
          </div>

          <!-- Office Team -->
          {% if office_admins %}
          <div class="bg-white rounded-2xl shadow-xl border border-slate-200 overflow-hidden">
            <div class="bg-gradient-to-r from-purple-600 to-purple-700 px-6 py-4">
              <h3 class="text-xl font-bold text-white flex items-center">
                <i class="fas fa-users mr-2"></i>
                Office Team
              </h3>
            </div>
            <div class="p-6">
              <div class="space-y-3">
                {% for admin in office_admins[:3] %}
                <div class="flex items-center space-x-3 p-3 bg-slate-50 rounded-xl">
                  <div class="w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center">
                    {% if admin.profile_pic %}
                    <img src="{{ url_for('static', filename='uploads/profile_pics/' + admin.profile_pic) }}" 
                         alt="{{ admin.get_full_name() }}" 
                         class="w-full h-full object-cover rounded-full">
                    {% else %}
                    <span class="text-sm font-medium text-purple-600">
                      {{ admin.first_name[0] }}{{ admin.last_name[0] }}
                    </span>
                    {% endif %}
                  </div>
                  <div class="flex-1 min-w-0">
                    <p class="text-sm font-medium text-slate-800 truncate">
                      {{ admin.get_full_name() }}
                    </p>
                    <p class="text-xs text-slate-500">Office Administrator</p>
                  </div>
                  <div class="flex-shrink-0">
                    <div class="w-3 h-3 bg-green-400 rounded-full"></div>
                  </div>
                </div>
                {% endfor %}
                
                {% if office_admins|length > 3 %}
                <div class="text-center">
                  <p class="text-sm text-slate-500">
                    +{{ office_admins|length - 3 }} more team member{{ 's' if office_admins|length - 3 != 1 else '' }}
                  </p>
                </div>
                {% endif %}
              </div>
            </div>
          </div>
          {% endif %}

          <!-- Quick Actions -->
          <div class="bg-white rounded-2xl shadow-xl border border-slate-200 overflow-hidden">
            <div class="bg-gradient-to-r from-emerald-600 to-emerald-700 px-6 py-4">
              <h3 class="text-xl font-bold text-white flex items-center">
                <i class="fas fa-bolt mr-2"></i>
                Quick Actions
              </h3>
            </div>
            <div class="p-6 space-y-3">
              {% if is_available %}
              <a href="{{ url_for('student.create_inquiry', office_id=office.id) if current_user.is_authenticated and current_user.role == 'student' else url_for('auth.login') }}"
                 class="flex items-center space-x-3 p-3 bg-emerald-50 hover:bg-emerald-100 rounded-xl transition-colors group">
                <div class="w-10 h-10 bg-emerald-100 group-hover:bg-emerald-200 rounded-lg flex items-center justify-center transition-colors">
                  <i class="fas fa-plus text-emerald-600"></i>
                </div>
                <div>
                  <p class="text-sm font-medium text-slate-800">New Inquiry</p>
                  <p class="text-xs text-slate-500">Submit a new request</p>
                </div>
              </a>
              {% endif %}
              
              {% if current_user.is_authenticated and current_user.role == 'student' %}
              <a href="{{ url_for('student.inquiries') }}"
                 class="flex items-center space-x-3 p-3 bg-blue-50 hover:bg-blue-100 rounded-xl transition-colors group">
                <div class="w-10 h-10 bg-blue-100 group-hover:bg-blue-200 rounded-lg flex items-center justify-center transition-colors">
                  <i class="fas fa-history text-blue-600"></i>
                </div>
                <div>
                  <p class="text-sm font-medium text-slate-800">My Inquiries</p>
                  <p class="text-xs text-slate-500">View your submissions</p>
                </div>
              </a>
              {% endif %}
              
              <a href="{{ url_for('main.offices') }}"
                 class="flex items-center space-x-3 p-3 bg-slate-50 hover:bg-slate-100 rounded-xl transition-colors group">
                <div class="w-10 h-10 bg-slate-100 group-hover:bg-slate-200 rounded-lg flex items-center justify-center transition-colors">
                  <i class="fas fa-building text-slate-600"></i>
                </div>
                <div>
                  <p class="text-sm font-medium text-slate-800">All Offices</p>
                  <p class="text-xs text-slate-500">Browse other offices</p>
                </div>
              </a>
            </div>
          </div>

        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}
